var Survey={};Survey.img={};Survey.img.one={};Survey.img.one.retina="images/img1-retina.jpg";Survey.img.one.full="images/img1-full.jpg";Survey.img.two={};
Survey.img.two.retina="images/img2-retina.jpg";Survey.img.two.full="images/img2-full.jpg";Survey.img.three={};Survey.img.three.retina="images/img3-retina.jpg";
Survey.img.three.full="images/img3-full.jpg";Survey.img.four={};Survey.img.four.retina="images/img4-retina.jpg";Survey.img.four.full="images/img4-full.jpg";
Survey.data={};Survey.setRandomImg=function(d){var c=Math.round(Math.random()),b=c===0?1:0,a=["zero","one","two","three","four"];$("#image"+d+" div:eq("+c+")").addClass("retina").css("background","url("+Survey.img[a[d]].retina+") no-repeat center");
$("#image"+d+" div:eq("+b+")").css("background","url("+Survey.img[a[d]].full+") no-repeat center");};Survey.showResults=function(){var b=0,a=4;$.each(Survey.data,function(){if(this=="Non-retina"){b+=1;
}});a=a-b;$("#retina").text("Retina preferred: "+a);$("#nonRetina").text("Non-retina Preferred: "+b);};Survey.saveData=function(){$.ajax({url:"/survey",type:"POST",data:Survey.data,success:function(){$("#results").prepend('<p class="success">Results saved!</p>');
},error:function(){$("#results").prepend('<p class="error">Error saving results.');}});};Survey.getData=function(){var e,j,k=0,c=0,b=0,d=0,f=0,h=0,a=0,g=0;
$.ajax({url:"/survey",type:"GET",async:false,success:function(l){e=l;}});j=e.length*4;$.each(e,function(){this.image1==="Retina"?b+=1:d+=1;this.image2==="Retina"?b+=1:d+=1;
this.image3==="Retina"?b+=1:d+=1;this.image4==="Retina"?b+=1:d+=1;if(this.device==="Retina"){k+=1;this.image1==="Retina"?f+=1:h+=1;this.image2==="Retina"?f+=1:h+=1;
this.image3==="Retina"?f+=1:h+=1;this.image4==="Retina"?f+=1:h+=1;}else{c+=1;this.image1==="Retina"?a+=1:g+=1;this.image2==="Retina"?a+=1:g+=1;this.image3==="Retina"?a+=1:g+=1;
this.image4==="Retina"?a+=1:g+=1;}});k*=4;c*=4;b=((b/j)*100).toFixed(2)+"%";d=((d/j)*100).toFixed(2)+"%";f=((f/k)*100).toFixed(2)+"%";h=((h/k)*100).toFixed(2)+"%";
a=((a/c).toFixed(2)*100)+"%";g=((g/c).toFixed(2)*100)+"%";$("#retinaSelected").text("Retina Preferred: "+b);$("#nonRetinaSelected").text("Non-retina Preferred: "+d);
$("#retinaSelectedRetina").text("Retina Preferred: "+f);$("#nonRetinaSelectedRetina").text("Non-retina Preferred: "+h);$("#retinaSelectedNonRetina").text("Retina Preferred: "+a);
$("#nonRetinaSelectedNonRetina").text("Non-retina Preferred: "+g);};$("#device-select").show();for(var i=1;i<5;i++){Survey.setRandomImg(i);}$("#device-select button").click(function(){Survey.data.device=$(this).text();
$(this).parent().hide();$("#image1").show();});$(".image").click(function(){var c=parseInt($(this).parent().attr("id").substr(-1),10),b=$(this).hasClass("retina"),a=b?"Retina":"Non-retina";
switch(c){case 1:Survey.data.image1=a;$(".survey-panel").hide();$("#image2").show();break;case 2:Survey.data.image2=a;$(".survey-panel").hide();$("#image3").show();
break;case 3:Survey.data.image3=a;$(".survey-panel").hide();$("#image4").show();break;case 4:Survey.data.image4=a;$(".survey-panel").hide();$("#results").show();
Survey.saveData();Survey.getData();Survey.showResults();break;}});